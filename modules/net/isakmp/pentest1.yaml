description: |-
  Этап 1 тестирования isakmp

  Статьи:
  https://book.hacktricks.xyz/network-services-pentesting/ipsec-ike-vpn-pentesting
  https://xakep.ru/2015/05/13/ipsec-security-flaws/
author: hacktricks
tags:
  - isakmp
  - IKE
  - IPsec
  - 500
  - 4500
  - udp
arguments:
  targs:
    default:
    replacer: __TARGS__
    description: >-
      Хосты для тестирования (пример: '10.0.0.1 10.0.1.3')
shell: bash
item_1:
  description: Сканирование скриптом Nmap 'ike-version' (-p500,4500)
  script: >-
    sudo nmap -Pn -sU -p500,4500 -sV --open --script=ike-version __TARGS__
item_2:
  description: Перечисление трансформаций
  script: >-
    for targ in __TARGS__; do echo "+ Testing $targ:500/udp"; patator ike_enum host=$targ transform=MOD0 0=TRANS aggressive=RANGE1 1=int:0-1 -x ignore:fgrep='NO-PROPOSAL'; echo -e; done



